---
title: "GDP and Regime"
author: "Cian Stryker"
date: "5/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(gt)
library(cowplot)
library(png)
library(scales)
library(janitor)
library(countrycode)
library(tidyverse)
```

```{r GDP Cleaning}

GDP <- read_csv("Data/GDP_World_Bank.csv", col_types = cols(
  .default = col_double(),
  `Country Name` = col_character(),
  `Country Code` = col_character(),
  `2019` = col_logical()
)) 

GDP <- GDP[, -c(2, 26)]

GDP <- GDP %>%
  pivot_longer(-`Country Name`,
                names_to = "year",
               values_to = "GDP") %>%
  clean_names() 

GDP$country_name <- countrycode(GDP$country_name, "country.name", "country.name")

GDP$country_code = GDP$country_name

GDP$country_code <- countrycode(GDP$country_code, "country.name", "iso2c")

GDP<- GDP[c(1, 4, 2, 3)]

```


```{r Map of Central Asia}

Central_Asia <- c("Kazakhstan", "Kyrgyzstan", "Tajikistan", "Turkmenistan", "Uzbekistan")

Central_Asia <- map_data("world", region = Central_Asia)

map.data <- Central_Asia %>%
  group_by(region) %>%
  summarise(long = mean(long), lat = mean(lat))

colnames(Central_Asia)[colnames(Central_Asia) == 'region'] <- 'country_name'

Central_Asia$country_name <- countrycode(Central_Asia$country_name, "country.name", "country.name")

```



```{r GDP CA Map}
GDP_2018 <- GDP %>%
  filter(year == 2018)

GDP_Map <- left_join(Central_Asia, GDP_2018, by = c("country_name"))
```

```{r}

Map1 <- ggplot(GDP_Map, aes( x = long, y = lat, group = group )) +
  geom_polygon(aes(fill = gdp), color = "white") +
  guides(fill = guide_legend(reverse = T,)) +
  scale_fill_gradientn(limits = c(7e+09, 2e+11), colours =   
       c('#461863','#404E88','#2A8A8C','#7FD157','#F9E53F'),
       values = rescale(c(7e+09, 8.e+09, 4.08e+10, 5.05e+10, 1.79e+11)),
       labels = c("7.5e+09", "4.1e+10", "5.0e+10", "1.8e+11"),
       breaks = c(7e+09, 4.08e+10, 5.05e+10, 1.79e+11)) +
  labs(fill = "GDP in USD",
       title = 'GDP in Central Asia: 2018',
       x = NULL,
       y = NULL, 
       caption = "Source: World Bank") +
  theme(text = element_text(color = '#333333'),
        plot.title = element_text(size = 12),
        plot.subtitle = element_text(size = 10),
        axis.ticks = element_blank(),
        axis.text = element_blank(),
        panel.grid = element_blank(),
        plot.background = element_rect(fill = '#CCCCCC'),
        legend.position = c(.91,.2),
        legend.background = element_rect(fill = '#CCCCCC'),
        legend.key = element_blank()
        ) 

```


```{r Regime, warning = FALSE}

Freedom_House <- read_excel("Data/Freedom_House.xlsx")

FH <- Freedom_House
FH$year <- FH$Edition

FH$country_name <- countrycode(FH$`Country/Territory`, "country.name", "country.name")

FH$country_code = FH$country_name

FH$country_code <- countrycode(FH$country_code, "country.name", "iso2c")

FH <- FH[, -c(1,2, 3)]

FH<- FH[c(3, 4, 2, 1)]

FH_Clean <- FH %>%
  drop_na() %>%
  clean_names() %>%
  filter(country_name %in% c("Ecuador", "Kazakhstan", "Kyrgyzstan", "Tajikistan", "Turkmenistan", "Uzbekistan"))

```


```{r Regime CA Map}

FH_2020<- FH_Clean %>%
  filter(year == 2020)

Regime_Map <- left_join(Central_Asia, FH_2020, by = c("country_name"))
```

```{r}

ggplot(Regime_Map, aes( x = long, y = lat, group = group )) +
  geom_polygon(aes(fill = total), color = "white") +
  guides(fill = guide_legend(reverse = TRUE)) +
  scale_fill_viridis_c(option = "C", limits = c(0, 100), labels = c("Not Free", " ","Partially Free", " ",  "Free"), breaks = c(0, 25, 50, 75, 100)) +
  labs(fill = "Index",
       title = 'Freedom House Scores in Central Asia: 2020',
       x = NULL,
       y = NULL,
       caption = "Source: Freedom House") +
  theme(text = element_text(color = '#333333'),
        plot.title = element_text(size = 12),
        plot.subtitle = element_text(size = 10),
        axis.ticks = element_blank(),
        axis.text = element_blank(),
        panel.grid = element_blank(),
        plot.background = element_rect(fill = '#CCCCCC'),
        legend.position = c(.9,.24),
        legend.background = element_rect(fill = '#CCCCCC'),
        legend.key = element_blank()
        ) 

```




